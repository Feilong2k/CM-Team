# TraceEvent Model and Lifecycle\n\n## What is a TraceEvent?\nA TraceEvent is a structured log entry that captures an interaction or event within the CM-TEAM system involving the app, Orion, and various tools. It provides a consistent schema for observability and debugging.\n\n## Typical Chat Turn Lifecycle\n\n1. **user_message**: Emitted by the chat route when a user sends a message.\n2. **llm_call**: Emitted by OrionAgent when calling the LLM.\n3. **tool_call** / **tool_result**: Emitted by DatabaseToolAgentAdapter or FileSystemTool when tools are invoked and return results.\n4. **orion_response**: Emitted when Orion replies to the user.\n\nThe `requestId` and `projectId` fields tie these events together as part of the same chat turn.\n\n## Redaction and Safety Rules\n\n- Sensitive data such as secrets, passwords, tokens, or full raw payloads must be summarized or redacted in the `details` field.\n- Only safe summaries or redacted snippets should be exposed via the API.\n\n## Mapping to `/api/trace/logs`\n\n- Subtask B2 will implement persistence of TraceEvents.\n- B2 will also implement the `GET /api/trace/logs` endpoint to return arrays of TraceEvents matching the contract defined in B1 and tested by Taraâ€™s tests.\n\nThis document serves as a reference for developers to understand the TraceEvent schema and lifecycle without needing to parse the JSON spec directly.\n
