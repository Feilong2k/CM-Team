# Bug Report B-0004

## Title
ChatPanel: after sending a user message, viewport does not align the latest user message to the top (scrollIntoView block:start)

## Description
As part of Subtask **P1-F2-T1-S12**, we added a behavior: after the user sends a message, the chat should scroll so the **latest user message** is aligned at the **top** of the scroll viewport (rather than the default “scroll to bottom”).

Clamp/expand is working, but the **scroll-to-top alignment is not**.

## Expected Behavior
After sending a user message:
- the chat scroll container should position the latest user message at the top of the viewport
- implementation intent: call `scrollIntoView({ block: 'start' })` on the latest user message element

## Actual Behavior
After sending a user message:
- the chat does not reposition to align the latest user message at the top

## Steps to Reproduce
1. Open the app and go to Chat Panel.
2. Ensure there are enough messages so the container can scroll.
3. Send a new user message.

## Notes / Likely Cause
- The current implementation in `frontend/src/components/ChatPanel.vue` attempts:
  - query `[data-testid="chat-msg-user"]`
  - call `scrollIntoView({ block: 'start', inline: 'nearest', behavior: 'instant' })`
- Potential issues:
  - `behavior: 'instant'` is not a standard scrollIntoView option (browsers typically accept `auto` or `smooth`), so it may be ignored.
  - The scroll may be overridden immediately after by other scroll logic (auto-scroll-to-bottom / indicator composable / DOM updates).
  - The call may happen before final layout (AI placeholder insertion, clamp layout, markdown render) stabilizes.

## Impact
Low/Medium. Feature is cosmetic/UX. Clamp/expand is still delivered.

## Suggested Next Steps
- Change to `scrollIntoView({ block: 'start', behavior: 'auto' })` and remove `inline` unless needed.
- Ensure this scroll action runs after DOM settles (e.g., after both user + AI placeholder are inserted), and does not conflict with auto-scroll behavior.
- Add manual QA:
  - with a long history, send a message and confirm alignment.

## Priority
Low

## Reporter
User report (via Cline)

## Date
2025-12-22
